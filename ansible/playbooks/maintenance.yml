# =============================================================================
# ANSIBLE/PLAYBOOKS/MAINTENANCE.YML - Playbook de maintenance
# =============================================================================
---
- name: ðŸ”§ Maintenance infrastructure Fode-DevOps
  hosts: fode_devops_prod
  become: yes
  
  tasks:
    - name: ðŸ§¹ Nettoyage des packages
      dnf:
        autoremove: yes
        
    - name: ðŸ”„ Mise Ã  jour des packages
      dnf:
        name: "*"
        state: latest
        
    - name: ðŸ“Š VÃ©rification de l'espace disque
      shell: df -h /
      register: disk_space
      
    - name: ðŸ“ˆ Affichage espace disque
      debug:
        msg: "{{ disk_space.stdout_lines }}"
        
    - name: ðŸ”„ RedÃ©marrage Apache si nÃ©cessaire
      systemd:
        name: httpd
        state: restarted
      when: system_update.changed
